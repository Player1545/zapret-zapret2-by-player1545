# zapret+zapret2-by-player1545
Решение создано на базе репозитория https://github.com/Flowseal/zapret-discord-youtube, а так же на базе https://github.com/bol-van/zapret2 (если быть точнее, на базе winws2 - https://github.com/bol-van/zapret-win-bundle)
<br>
<br>
Отдельная благодарность <a href="https://github.com/Flowseal">Flowseal</a> и <a href="https://github.com/bol-van">bol-van</a>.
<br>
Вы так же можете материально поддержать оригинального разработчика zapret <a href="https://github.com/bol-van/zapret?tab=readme-ov-file#%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%B0%D1%82%D1%8C-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%87%D0%B8%D0%BA%D0%B0">здесь</a>.
<br>
<p><b>По поводу замедления телеграм - читаете в самом низу README</b></p>
<br>
<hr>
<h2>Как запускать?</h2>
<p>1. Скачайте архив со страницы последнего релиза (на странице Releases)</p>
<p>2. Разархивируйте папку из архива в любое удобное вам место</p>
<p>3. Вручную запустите любую из стратегий (любой из bat файлов), программы winws и winws2 могут попросить у вас права администратора, в таком случае <b>разрешите программам winws и winws2 запуститься от имени администратора</b>.</p>
<p>Если при запуске bat файла у вас возникло подобное предупреждение, которое представлено ниже, пропишите "y" или "a".</p>
<code>Security Warning: Script Execution Risk
Invoke-WebRequest parses the content of the web page. Script code in the web page might be run when the page is
parsed.
      RECOMMENDED ACTION:
      Use the -UseBasicParsing switch to avoid script code execution.
</code>
<br>
<p>Рекомендация: рекомендую использовать стратегии general.bat либо general(ALT9).bat.</p>
<p>Уточнение: программы winws и winws2 - это главные компоненты и они не несут в себе вредоносного кода. Если вы мне не верите, репозитории данных программ с открытым исходным кодом всегда доступны - <a href="https://github.com/bol-van/zapret">zapret</a>, <a href="https://github.com/bol-van/zapret2">zapret2</a>.</p>
<p>Второе уточнение: Вы не сможете через service.bat установить zapret как сервис. Подробнее читайте здесь: <a href="https://github.com/Player1545/zapret-zapret2-by-player1545?tab=readme-ov-file#%D0%BF%D1%80%D0%BE-servicebat">Про service.bat</a></p>
<p>Третье уточнение: по умолчанию у вас будет включен Game Filter. Если он вам не нужен, вы можете выключить его через service.bat, прописав цифру 6.</p>
<p><b>ПОМНИТЕ!</b> zapret (и zapret2) - это <b>НЕ впн</b>! Он не меняет ваш айпи и не прокидывает ваш трафик через иностранные серверы. Это утилита для десинхронизации (дурения) DPI у провайдера, но никак не программа, меняющая ваш айпи и/или геолокацию.</p>
<p><b>Если у вас не работают звонки в дискорде, читайте решение здесь - </b><a href="https://github.com/Player1545/zapret-zapret2-by-player1545#%D1%87%D1%82%D0%BE-%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-%D1%81-%D0%BD%D0%B5%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%D1%8E%D1%89%D0%B8%D0%BC%D0%B8-%D0%B7%D0%B2%D0%BE%D0%BD%D0%BA%D0%B0%D0%BC%D0%B8-%D0%B2-discord">Что делать с неработающими звонками в discord?</a>. <b>Если данное решение вам не помогло - рекомендую использовать Cloudflare Warp или Внезапный Переезд в Нидерладны</b>.</p>
<br>
<hr>
<h2>Зачем это нужно?</h2>
<br>
<p>Данный костыль создан по большей части из-за того, что я не разобрался, как грамотно перенести стратегию из zapret-discord-youtube в стратегию для winws2, отвечающую за фильтрацию портов по UDP для обхода блокировок игр. Я пытался применять различные параметры к fake в стратегии для winws2, пробовал менять метод десинхронизации, но результат был один - игры не грузились.</p>
<p>Зачем переделывать стратегии из zapret-discord-youtube под winws2? Просто потому что zapret2 имеет больше протоколов для пейлоадов и фильтрации на l7.</p>
<hr>
<h2>Структура проекта</h2>
<br>
<ul>
  <li><b>general.bat</b> - основная стратегия</li>
  <li><b>general (ALT...).bat</b> - запасные стратегии, на случай если не работает основная</li>
  <li><b>service.bat</b> - батник с полезными инструментами по типу удаления сервиса, запуска игрового фильтра (взят из репозитория zapret-discord-youtube от Flowseal)</li>
  <li><b>bin</b> - бинарные файлы(часть взята из zapret, часть из zapret2)</li>
  <li><b>lists</b> - папка с листами для zapret и zapret2</li>
  <ul>
      <li><b>list-general.txt</b> - основной лист с хостами</li>
      <li><b>ipset-all.txt</b> - основной лист с айпи адресами и диапазонами</li>
      <li><b>list-telegram.txt</b> - лист с хостами для телеграм</li>
      <li><b>ipset-telegram.txt</b> - лист с айпи адресами и диапазонами для телеграм</li>
      <li><b>list-auto.txt</b> - лист для автоматического добавления хостов, работает только на general (ALT2).bat</li>
      <li><b>list-google.txt</b> - лист с хостами для ютуба</li>
      <li><b>ipset-all.txt.backup</b> - бэкап айписета, содержит множетво диапазонов айпи</li>
      <li><b>list-exclude.txt</b> - лист с хостами для исключения, к ним не будет применяться десинхронизация DPI.</li>
      <li><b>ipset-exclude.txt</b> - лист с айпи адресами и диапазонами для исключения, к ним не будет применяться десинхронизация DPI.</li>
  </ul>
  <li><b>lua</b> - папка с Lua скриптами для winws2 (взята из репозитория zapret2 от bol-van)</li>
</ul>
<hr>
<h2>Про service.bat</h2>
<br>
<p>В нём я отключил пункт 1 на некоторое время, так как изначально он не был рассчитан под два winws-а. Он был рассчитан только под winws.exe, однако в моём репозитории есть ещё и winws2.exe, под него service.bat не рассчитан.</p>
<br>
<hr>
<h2>Что делать с неработающими звонками в discord?</h2>
<p><a href="https://github.com/Flowseal/zapret-discord-youtube/issues/8028">Решение можете найти здесь.</a></p>
<br>
<p>Однако если у вас всё ещё не работают звонки в discord, попробуйте сменить регион войса на Rotterdam.</p>
<p>На серверах вы сможете сделать это в настройках голосового канала, конечно если у вас есть права на его редактирование. Заходите в настройки голосового канала, в пункте "Назначение региона" меняйте регион с "Автоматический выбор" на "Rotterdam"(это регион под "Japan").</p>
<p>В личных сообщениях: кликайте на кнопку "Другие настройки" (это кнопка рядом с кнопкой "Отключиться", буквально эта кнопка левее кнопки "Отключиться", имеет иконку "..."), дальше кликайте на "регион" и меняйте его на "Rotterdam"(это регион под "Japan").</p>
<br>
<p>Надеюсь, что хоть как-то вам помог.</p>
<br>
<hr>
<h2>Про телеграм</h2>
<br>
<p>Сегодня, 10.02.2026, Роскомнадзор начал активно замедлять телеграм. Телеграмом стало невозможно пользоваться: долгая отправка текстовых, голосовых, видео сообщений, очень долгая загрузка и отправка медиа.</p>
<p>UPD от 15.02.2026: найден метод для оживления веб версии телеграм. Скачивайте версию 1.3 моего репозитория, в service.bat прописывайте 9, дополняете файл Hosts. Учтите, что <b>для десктопного приложения телеграм это не поможет</b>.</p>
<p>Как с этим бороться?</p>
<p>Во первых: учтите, что zapret и вероятнее всего zapret2, вам не помогут. Я пробовал использовать обе версии zapret (проводил замеры скорости отправки файла размером 180 мегабайт 05.02.2026) - результат один, нулевой, ничего не менялось. Нормальная скорость отправки файла: 40 +-10 секунд, с замедлением (и включенным winws, winws2): 20 +-10 <b>минут</b>.</p>
<p>Так что вам стоит использовать AmneziaWG - <a href="https://github.com/amnezia-vpn/amneziawg-windows-client">https://github.com/amnezia-vpn/amneziawg-windows-client</a>.</p>
<p>Для AmneziaWG вам нужно будет сгенерировать конфиг, который в качестве "Разрешённых IP-адресов"(IP-адресов, которые будут фильтроваться) будет использовать CIDR telegram. Их вы можете найти здесь - <a href="https://iplist.opencck.org/?format=text&data=cidr4&site=telegram.org">https://iplist.opencck.org/?format=text&data=cidr4&site=telegram.org</a>.</p>
<p>Вы можете так же сгенерировать конфиг при помощи инструмента, который позволяет выбирать IP-адреса для фильтрации (или который позволяет сразу сделать конфиг для определённого сайта). Пока телеграм не заблокировали окончательно, могу порекомендовать этот генератор конфигов - <a href="https://t.me/warp_generator_bot">https://t.me/warp_generator_bot</a>.</p>
<p>Далее добавляйте в качестве туннеля сгенерированный конфиг, подключайтесь к нему, перезапускаете Telegram Desktop. Телеграм должен будет работать стабильно, проблема с замедленной отправкой сообщений и загрузкой медиа должна решиться.</p>
